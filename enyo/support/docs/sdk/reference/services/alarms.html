<!DOCTYPE html>
<html>
	<head>
		<title>$if(pagetitle)$$pagetitle$$endif$</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link rel="stylesheet" href="_css/chrome.css" />
		<link rel="stylesheet" href="../_css/chrome.css" />
		<link rel="stylesheet" href="../../_css/chrome.css" />
		<link rel="stylesheet" href="../../../_css/chrome.css" />
		<script src="_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../../../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="_js/doc.js" type="text/javascript"></script>
		<script src="../_js/doc.js" type="text/javascript"></script>
		<script src="../../_js/doc.js" type="text/javascript"></script>
		<script src="../../../_js/doc.js" type="text/javascript"></script>
	</head>
	<body>
		<div id="content">
    
    <h1 id="alarms">
      Alarms
    </h1>
    <p>
      Real Time Clock (RTC) alarms are timers that signal the user at a preset time or at a certain interval from the current time. Alarms <em>can</em> wake up the device when the alarm activates, though by default, they do not. RTC alarm functionality is provided as a Service through a service request. They are intended to wake applications (whether minimized or maximized) or to drive polling for Dashboard applications.
    </p>
    <p>
      There are two types of alarms:
    </p>
    <ul>
      <li>
        <strong>Monotonic</strong> (in a certain period): A monotonic-time alarm causes the device to wake and activate an alarm at a fixed time interval in the future. This is independent of clock time changes. The maximum period for monotonic alarms is 24 hours.
      </li>
      <li>
        <strong>Calendar</strong> (at a certain time and date): A calendar alarm causes the device to wake and activate an alarm at a specific calendar time. Calendar alarms do not have the 24 hours time limit.
      </li>
    </ul>
    <p>
      An alarm wakes up your application by launching (or relaunching) it through the Application Manager service. The parameters to the applicationManager service call pass to your application during the creation of its stage assistant.
    </p>
    <p>
      To receive an alarm callback, your application assistant requires a handleLaunch() method that handles parameters passed from the application manager, and then calls stageController.activate() to bring your application to the foreground.
    </p>
    <p>
      <strong>Notes:</strong>
    </p>
    <ul>
      <li>Setting an alarm timeout with the same key from the same application overwrites the existing alarm timeout with the new parameters.
      </li>
      <li>By default, the event does not wake up the device. If the timeout expires while the device is asleep, the timer activates when the device next wakes. To create an alarm timeout that does wake up the device, set the wakeup parameter to true.
      </li>
      <li>Alarms are preserved across a reboot. If an alarm expired while the device was shutdown, the alarm activates when the device restarts.
      </li>
      <li>Alarms are coarse-grained. An alarm may activate up to 2 seconds off from the intended time.
      </li>
      <li>When an alarm fires (if &quot;wakeup&quot; is set to true), webOS starts or restarts an activity to keep the device awake long enough for the client code to do something useful. This is a fixed, 5-second activity with the name &quot;com.palm.power.timeout_fired&quot;.
      </li>
      <li>See Power Management Service for information on activities.
      </li>
    </ul>
    <h2 id="uri">
      URI
    </h2>
    <p>
      The URI is as follows:
    </p>
    <blockquote>
      <p>
        palm://com.palm.power/timeout
      </p>
    </blockquote>
    <h2 id="methods">
      Methods
    </h2>
    <p>
      This section describes the following methods:
    </p>
    <ul>
      <li>set
      </li>
      <li>clear
      </li>
    </ul>
    <h3 id="set">
      set
    </h3>
    <p>
      Creates a new alarm with the provided alarm object.
    </p>
    <p>
      Required parameters:
    </p>
    <ul>
      <li>key
      </li>
      <li>Either in or at
      </li>
      <li>URI
      </li>
      <li>params
      </li>
    </ul>
    <h4 id="parameters">
      Parameters
    </h4>
    <table border="1">
      <tbody>
        <tr>
          <th>
            Parameter
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
        <tr>
          <td>
            at
          </td>
          <td>
            string
          </td>
          <td>
            Creates a calendar-based alarm in GMT (i.e., UTC).<br>
            <ul>
              <li>Either at or in is required.
              </li>
              <li>Format is &quot;mm/dd/yyyy hh:mm:ss&quot;.
              </li>
            </ul>
          </td>
        </tr>
        <tr>
          <td>
            in
          </td>
          <td>
            string
          </td>
          <td>
            Creates a relative alarm (minimum alarm time is &quot;00:05:00&quot; 5 minutes).
            <ul>
              <li>Either at or in is required.
              </li>
              <li>Format is &quot;hh:mm:ss&quot;.
              </li>
            </ul>
          </td>
        </tr>
        <tr>
          <td>
            key
          </td>
          <td>
            object
          </td>
          <td>
            The identifier for timeout. Format is &quot;com.X.X.timer&quot;.
          </td>
        </tr>
        <tr>
          <td>
            params
          </td>
          <td>
            object
          </td>
          <td>
            Payload of the message that is sent when the timeout expires. The format of the payload depends on the key (service) used.
          </td>
        </tr>
        <tr>
          <td>
            uri
          </td>
          <td>
            string<br>
          </td>
          <td>
            URI of the message that is sent when the timeout expires. Format is &quot;palm://com.X.X/method&quot;.
          </td>
        </tr>
        <tr>
          <td>
            wakeup
          </td>
          <td>
            boolean
          </td>
          <td>
            Wakes up the device when the timeout expires. Default is false.
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="return-handling">
      Return Handling
    </h4>
    <p>
      <strong>onSuccess</strong>
    </p>
    <p>
      An object is returned with the following attributes:
    </p>
    <table border="1">
      <tbody>
        <tr>
          <th>
            Attribute
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
        <tr>
          <td>
            key
          </td>
          <td>
            string
          </td>
          <td>
            The key that was passed in.
          </td>
        </tr>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            true
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>onFailure</strong>
    </p>
    <p>
      An object is returned with the following attributes:
    </p>
    <table border="1">
      <tbody>
        <tr>
          <th>
            Attribute
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
        <tr>
          <td>
            errorText
          </td>
          <td>
            string
          </td>
          <td>
            A string representing the error for display if needed. One of the following:
            <ul>
              <li>Timeout value for &quot;in&quot; less than 5 minutes.
              </li>
              <li>Invalid format for &quot;timeout/set&quot;.
              </li>
              <li>Malformed JSON.
              </li>
              <li>Could not set timeout.
              </li>
            </ul>
          </td>
        </tr>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            false
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="example">
      Example
    </h4>
    <blockquote>
      <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.power/timeout&quot;, {
  method: &quot;set&quot;,
  parameters: {
      &quot;wakeup&quot;: true,
      &quot;key&quot;: &quot;yourKeyName&quot;,
      &quot;uri&quot;: &quot;palm://com.palm.applicationManager/launch&quot;,
      &quot;params&quot;: '{&quot;id&quot;:&quot;com.YourDomain.YourApp&quot;,&quot;params&quot;:{&quot;action&quot;:&quot;setTimeout&quot;}}',
          &quot;at&quot;: &quot;01/01/2009 17:45:00&quot;
  },
  onSuccess: myCallback,
  onFailure: myFailureCallback
});    
</code>
</pre>
    </blockquote>
    <h3 id="clear">
      clear
    </h3>
    <p>
      Requests the named &quot;key&quot; timer to be cleared.
    </p>
    <p>
      Required parameter:
    </p>
    <ul>
      <li>key
      </li>
    </ul>
    <h4 id="parameters-1">
      Parameters
    </h4>
    <table border="1">
      <tbody>
        <tr>
          <th>
            Parameter
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
        <tr>
          <td>
            key
          </td>
          <td>
            string
          </td>
          <td>
            Identifier of the timeout to remove. Format is &quot;com.X.X.timer&quot;.
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="return-handling-1">
      Return Handling
    </h4>
    <p>
      <strong>onSuccess</strong>
    </p>
    <p>
      An object is returned with the following attributes:
    </p>
    <table border="1">
      <tbody>
        <tr>
          <th>
            Attribute
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
        <tr>
          <td>
            key
          </td>
          <td>
            string
          </td>
          <td>
            The key that was passed in.
          </td>
        </tr>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            true
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>onFailure</strong>
    </p>
    <p>
      An object is returned with the following attributes:
    </p>
    <table border="1">
      <tbody>
        <tr>
          <th>
            Attribute
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
        <tr>
          <td>
            errorText
          </td>
          <td>
            string
          </td>
          <td>
            A string representing the error for display if needed. One of the following:
            <ul>
              <li>Could not find key.
              </li>
              <li>Malformed JSON.
              </li>
            </ul>
          </td>
        </tr>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            boolean
          </td>
          <td>
            false
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="example-1">
      Example
    </h4>
    <blockquote>
      <pre>
<code>this.schedulerSetRequest = new Mojo.Service.Request(
  &quot;palm://com.palm.power/timeout&quot;, {
      method: &quot;clear&quot;,
      parameters: {&quot;key&quot;: &quot;yourKeyName&quot;},
      onSuccess: myCallback,
      onFailure: myFailureCallback
  }
);    
</code>
</pre>
    </blockquote>
    <h2 id="examples">
      Examples
    </h2>
    <p>
      This section shows example uses of the Alarms service.
    </p>
    <h3 id="set-calendar-based-time">
      Set Calendar-Based Time
    </h3>
    <p>
      Set a calendar event to activate at 04-03-2009 at 21:35:00 GMT (UTC).
    </p>
    <blockquote>
      <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.power/timeout&quot;, {
  method: &quot;set&quot;,
  parameters: {
      &quot;wakeup&quot;: true,
      &quot;key&quot;: &quot;calendarEvent&quot;,
      &quot;uri&quot;: &quot;palm://com.palm.applicationManager/open&quot;,
      &quot;params&quot; : &quot;{'id': 'com.palm.calendarEvent','params': {}}&quot;,&quot;at&quot;: &quot;04/03/2009 21:35:00&quot;
  },
  onSuccess: myCallback,
  onFailure: myFailureCallback
});    
</code>
</pre>
    </blockquote>
    <h3 id="set-an-egg-timer-to-activate-1-hr-from-now">
      Set an Egg Timer to Activate 1 hr From Now
    </h3>
    <blockquote>
      <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.power/timeout&quot;, {
  method: &quot;set&quot;,
  parameters: {
      &quot;wakeup&quot; : true,
      &quot;key&quot; : &quot;egg1&quot;,
      &quot;uri&quot;: &quot;palm://com.palm.applicationManager/open&quot;,
      &quot;in&quot; : &quot;01:00:00&quot;,
      &quot;params&quot; : &quot;{'id':'com.palm.eggtimer','params': {'alarm': 'egg1'}}&quot;
  }
});    
</code>
</pre>
    </blockquote>
    <h3 id="remove-egg-timer">
      Remove Egg Timer
    </h3>
    <blockquote>
      <pre>
<code>this.controller.serviceRequest('palm://com.palm.power/timeout', {
  method: &quot;clear&quot;,
  parameters: {&quot;key&quot; : &quot;eggtime&quot;}
});    
</code>
</pre>
    </blockquote>
    <h3 id="schedule-a-news-fetch-with-a-twist">
      Schedule a News Fetch with a Twist
    </h3>
    <p>
      Schedule a news fetch in 30 minutes, but only activate if the device is already awake. If the timeout expires when the device is asleep, the timeout activates the next time the device wakes.
    </p>
    <p>
      This is an opportunistic way of using the timer and helps save battery power. This is especially useful when the request is not urgent or needs the user immediate attention.
    </p>
    <blockquote>
      <pre>
<code>this.controller.serviceRequest('palm://com.palm.power/timeout', {
  method: &quot;set&quot;,
  parameters: {                 
      &quot;key&quot;: &quot;news_fetch&quot;,
      &quot;in&quot;: &quot;00:30:00&quot;,
      &quot;wakeup&quot;: false,
      &quot;uri&quot;: &quot;palm://com.palm.applicationManager/open&quot;,
      &quot;params&quot;: &quot;{'id':'com.palm.news','params':{'action': 'fetch'}}&quot;
  }  
});
</code>
</pre>
    </blockquote>
		</div>
	</body>
</html>