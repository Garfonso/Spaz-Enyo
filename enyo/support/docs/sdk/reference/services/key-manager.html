<!DOCTYPE html>
<html>
	<head>
		<title>$if(pagetitle)$$pagetitle$$endif$</title>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<link rel="stylesheet" href="_css/chrome.css" />
		<link rel="stylesheet" href="../_css/chrome.css" />
		<link rel="stylesheet" href="../../_css/chrome.css" />
		<link rel="stylesheet" href="../../../_css/chrome.css" />
		<script src="_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="../../../_js/jquery-1.4.2.min.js" type="text/javascript"></script>
		<script src="_js/doc.js" type="text/javascript"></script>
		<script src="../_js/doc.js" type="text/javascript"></script>
		<script src="../../_js/doc.js" type="text/javascript"></script>
		<script src="../../../_js/doc.js" type="text/javascript"></script>
	</head>
	<body>
		<div id="content">
    
    <h1 id="key-manager">
      Key Manager
    </h1>
    <p>
      The Key Manager (KM) provides JavaScript applications with key management and cryptographic functionality. It makes this available on the device's public bus via a number of API calls. The Key Manager implements a key <em>store</em>, allowing apps a place to safely keep keys where they are readily available for cryptographic operations.
    </p><img src="/images/km.jpg">
    <p>
      The Key Manager is designed to do the following:
    </p>
    <ul>
      <li>
        <p>
          Provide apps and services easy access to cryptographic functions they need to perform local tasks safely, comply with standards, and interact with external services.
        </p>
      </li>
      <li>
        <p>
          Protect user secrets (keys, passwords, etc.) in the event of loss or theft. Even if the device is in Developer Mode, possession alone should not provide access to secrets.
        </p>
      </li>
      <li>
        <p>
          Protect application secrets (keys, tokens, etc.) from disclosure to the user or other applications.
        </p>
      </li>
      <li>
        <p>
          Provide apps and services access, via a flexible and easy-to-use interface, to commonly used encryption algorithms such as AES, 3DES, and HMAC, and digest functions such as SHA-1.
        </p>
      </li>
    </ul>
    <p>
      Keys are stored encrypted in a database. They have both an app name (i.e., <code>&quot;com.someone.appname&quot;</code>) and a key name. The latter is not necessarily unique—two different apps can both have a key with the same name. However, the Key Manager service obtains the app name from the protocol, making it almost impossible for apps to use the same keys.
    </p>
    <p>
      An app can use the KM service to store or generate a key while specifying its encryption algorithm type, length, and an option to <em>hide</em> the key and never return it to the application, though it remains available for cryptographic operations.
    </p>
    <p>
      <strong>In this section:</strong>
    </p>
    <ul>
      <li>
        <a href="#supported-key-types">Supported Key Types</a>
      </li>
      <li>
        <a href="#supported-block-cipher-modes">Supported Block Cipher Modes</a>
      </li>
      <li>
        <a href="#supported-block-cipher-padding-modes">Supported Block Cipher Padding Modes</a>
      </li>
      <li>
        <a href="#methods">Methods</a>
      </li>
    </ul>
    <hr>
    <h2 id="supported-key-types">
      Supported Key Types
    </h2>
    <p>
      In cryptography, a key is a piece of information (a parameter) that determines the functional output of a cryptographic algorithm or cipher. Without a key, the algorithm would have no result. In encryption, a key specifies the particular transformation of plaintext (unencrypted text) into ciphertext (encrypted text), or vice-versa during decryption. Keys are also used in other cryptographic algorithms, such as digital signature schemes and message authentication codes.
    </p>
    <p>
      Key Manager supports the following key encryption algorithm types:
    </p>
    <ul>
      <li>
        <p>
          AES—Advanced Encryption Standard. AES-128, AES-192, and AES-256 are supported.
        </p>
      </li>
      <li>
        <p>
          3DES (3 key outer CBC)—The size includes the padding.
        </p>
      </li>
      <li>
        <p>
          HMAC — SHA1 —Hash-based Message Authentication Code - Secure Hash Algorithm-1 . Any size from 16 bytes up is supported.
        </p>
      </li>
      <li>
        <p>
          BLOB—For storing any type of data, up to 4k bytes.
        </p>
      </li>
      <li>
        <p>
          ASCIIBLOB—An ascii (non-base64 encoded) BLOB. The data must be in valid JSON format with no unescaped JSON formatting characters.
        </p>
      </li>
    </ul>
    <hr>
    <h2 id="supported-block-cipher-modes">
      Supported Block Cipher Modes
    </h2>
    <p>
      A block cipher is a type of symmetric-key encryption algorithm that transforms a fixed-length block of plaintext data into a block of ciphertext data of the same length. This transformation takes place with the aid of a user-provided secret key. Decryption is performed by applying the reverse transformation to the ciphertext block using the same secret key. The fixed length is called the block size, and for many block ciphers, the block size is 64 bits or 128 bits.
    </p>
    <p>
      AES and 3DES are the supported block ciphers.
    </p>
    <p>
      Key Manager supports the following block cipher modes:
    </p>
    <ul>
      <li>CBC—Cipher Block Chaining.
      </li>
      <li>ECB—Electronic CodeBook.
      </li>
      <li>CFB—Cipher FeedBack Mode.
      </li>
    </ul>
    <hr>
    <h2 id="supported-block-cipher-padding-modes">
      Supported Block Cipher Padding Modes
    </h2>
    <p>
      Because a block cipher works on units of a fixed size, but messages come in a variety of lengths, some modes (mainly CBC) require that the final block be padded before encryption.
    </p>
    <p>
      Key Manager supports the following block cipher padding modes:
    </p>
    <ul>
      <li>None—Data must be a multiple of the block size.
      </li>
      <li>PKCS1—Public Key Cryptography Standards #1.
      </li>
    </ul>
    <hr>
    <h2 id="methods">
      Methods
    </h2>
    <p>
      You can asynchronously call Key Manager methods through the <code>serviceRequest</code> function which takes 2 parameters:
    </p>
    <ul>
      <li>The Key Manager URI (Uniform Resource Identifier).
      </li>
      <li>A JSON (JavaScript Object Notation) object containing parameters, callback functions, and other data.
      </li>
    </ul>
    <p>
      Depending on outcome, the API returns a JSON result to either the success or failure callback function. These functions can then parse the result. Your app needs to take into account the call's asynchronous nature (results may be delayed) and not block user interaction while awaiting results.
    </p>
    <h3 id="about-json">
      About JSON
    </h3>
    <p>
      For more information on calling services such as Key Manager, see the Services Overview.
    </p>
    <p>
      JSON is a lightweight data-interchange text format based on a subset of the JavaScript programming language that is easy for humans to read and write and for machines to parse and generate. Like XML, JSON contains name/value pair collections and ordered list of values (i.e., arrays).
    </p>
    <p>
      For more information on JSON, see the following websites:
    </p>
    <ul>
      <li>JSON objects, values and format—<a href="http://www.json.org/" target="_blank">http://www.json.org/</a>
      </li>
      <li>JSON schemas—<a href="http://tools.ietf.org/html/draft-zyp-json-schema-02" target="_blank">http://tools.ietf.org/html/draft-zyp-json-schema-02</a>
      </li>
    </ul>
    <p>
      A primer on how JSON data objects are formatted is beyond the scope of this document—consult the two links above for more information. However, in brief:
    </p>
    <ul>
      <li>Curly brackets ('{', '}') are used to enclose objects.
      </li>
      <li>Angle brackets ('[', ']') are used to enclose arrays.
      </li>
      <li>Colons (':') are used as delimiters in name/value pairs.
      </li>
      <li>Quotes (&quot;) are used for string values. Numeric values are not quoted.
      </li>
    </ul>
    <h3 id="data-formatting">
      Data Formatting
    </h3>
    <p>
      Since JSON objects are composed and formatted with ascii (UTF-8) text, data to and from the Key Manager service needs to be base64 encoded to avoid having it interpreted as JSON formatting instructions. This includes key data, data to be encrypted or decrypted, and IVs (Initialization Vectors). The webOS JavaScript foundation libraries provide the following base64 encoding and decoding functions: TBD
    </p>
    <h3 id="key-manager-public-methods">
      Key Manager Public Methods
    </h3>
    <ul>
      <li>
        <a href="#crypt">crypt</a>—Encrypts or decrypts data.
      </li>
      <li>
        <a href="#export">export</a>—Wraps a key using a specified wrapping key.
      </li>
      <li>
        <a href="#fetchKey">fetchKey</a>—Returns key metadata and key data.
      </li>
      <li>
        <a href="#generate">generate</a>—Generates a key.
      </li>
      <li>
        <a href="#import">import</a>—Takes a wrapped key and imports it.
      </li>
      <li>
        <a href="#keyInfo">keyInfo</a>—Returns key metadata but not the key data.
      </li>
      <li>
        <a href="#remove">remove</a>—Deletes a key from the database.
      </li>
      <li>
        <a href="#store">store</a>—Stores a key in the database.
      </li>
    </ul>
    <p>
      <a name="crypt" id="crypt">&#160;</a>
    </p>
    <hr>
    <h3 id="crypt">
      crypt
    </h3>
    <p>
      You can use this API to encrypt or decrypt data. The key encryption algorithm specified (AES, 3DES, or HMACSHA1) <strong><em>must</em></strong> be the same as the one used to create the key.
    </p>
    <p>
      Key data needs to be base64 encoded. Since JSON objects are composed and formatted with ascii (UTF-8) text, data needs to be base64 encoded to avoid having it interpreted as JSON formatting instructions. The webOS JavaScript foundation libraries provide the following base64 encoding/decoding functions: <strong>TBD</strong>
    </p>
    <h4 id="schema">
      Schema
    </h4>
    <blockquote>
      <pre>
<code>{
  &quot;keyname&quot;   : string,
  &quot;algorithm&quot; : string,
  &quot;pad&quot;       : string,
  &quot;mode&quot;      : string,
  &quot;iv&quot;        : string,
  &quot;decrypt&quot;   : boolean,
  &quot;data&quot;      : string
}
</code>
</pre>
    </blockquote>
    <h4 id="parameters">
      Parameters
    </h4>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            keyname
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            Key name.
          </td>
        </tr>
        <tr>
          <td>
            algorithm
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            Possible values: <code>&quot;AES&quot;, &quot;3DES&quot;, or &quot;HMACSHA1&quot;</code>.
          </td>
        </tr>
        <tr>
          <td>
            pad
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Possible values: <code>&quot;PKCS1&quot;</code>, or <code>&quot;none&quot;</code>. Required for block ciphers.
          </td>
        </tr>
        <tr>
          <td>
            mode
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Possible values: <code>&quot;CBC&quot;, &quot;CFB&quot;, &quot;ECB&quot;, or &quot;none&quot;</code>. This is only appropriate for block ciphers. <code>none</code> is not valid for block ciphers.
          </td>
        </tr>
        <tr>
          <td>
            iv
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Initialization Vector—a block of bits that is required to allow a stream cipher or a block cipher to to produce a unique stream independent from other streams produced by the same encryption key without having to go through a re-keying process. Only required for CBC and CFB modes. 16 bytes for AES, 8 bytes for 3DES.
          </td>
        </tr>
        <tr>
          <td>
            decrypt
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>false</code> to encrypt, <code>true</code> to decrypt.
          </td>
        </tr>
        <tr>
          <td>
            data
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            Data to encrypt or decrypt.
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns">
      Returns
    </h4>
    <blockquote>
      <pre>
<code>{
  &quot;returnValue&quot; : boolean,
  &quot;errorText&quot;   : string, |
  &quot;data&quot;        : string
}
</code>
</pre>
    </blockquote>
    <table border="1">
      <tbody>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure)
          </td>
        </tr>
        <tr>
          <td>
            errorText
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Error message returned on failure.
          </td>
        </tr>
        <tr>
          <td>
            data
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Encrypted data.
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <blockquote>
      <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.keymanager/&quot;, {
  method: &quot;crypt&quot;,
  parameters: {
      &quot;keyname&quot;   : &quot;myKey&quot;,
      &quot;algorithm&quot; : &quot;AES&quot;,
      &quot;decrypt&quot;   : false,
      &quot;data&quot;      : &quot;Here is my secret, secret credit card number: 3456-8720-8735=0678&quot;
  },
  onSuccess: function(e){ Mojo.Log.info(&quot;Crypt success, data=&quot;+e.data); },
  onFailure: function(e){ Mojo.Log.info(&quot;Crypt failure, err=&quot;+e.errorText); }
});
</code>
</pre>
    </blockquote>
    <p>
      <a name="export" id="export">&#160;</a>
    </p>
    <hr>
    <h3 id="export">
      export
    </h3>
    <p>
      Wraps a key using a specified wrapping key. Both keys must belong to the same owner. A key can not wrap itself.
    </p>
    <h4 id="schema-1">
      Schema
    </h4>
    <blockquote>
      <pre>
<code>{ 
  &quot;keyname&quot;        : string,
  &quot;wrappingkeyname&quot;: string
}
</code>
</pre>
    </blockquote>
    <h4 id="parameters-1">
      Parameters
    </h4>
    <table border="1">
      <tbody>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
        <tr>
          <td>
            keyname
          </td>
          <td>
            string
          </td>
          <td>
            Key name.
          </td>
        </tr>
        <tr>
          <td>
            wrappingkeyname
          </td>
          <td>
            string
          </td>
          <td>
            Wrapping key name.
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns-1">
      Returns
    </h4>
    <blockquote>
      <pre>
<code>{
  &quot;returnValue&quot; : boolean,
  &quot;errorText&quot;   : string, |
  &quot;wrappedkey&quot;  : string
}
</code>
</pre>
    </blockquote>
    <table border="1">
      <tbody>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure)
          </td>
        </tr>
        <tr>
          <td>
            errorText
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Error message returned on failure.
          </td>
        </tr>
        <tr>
          <td>
            wrappedkey
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Wrapped key returned on success.
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <blockquote>
      <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.keymanager/&quot;, {
  method: &quot;export&quot;,
  parameters: {
      &quot;keyname&quot;: &quot;MyKey&quot;,
      &quot;wrappingkeyname&quot;: &quot;MyWrappingKey&quot;
  },
  onSuccess: function(e) {Mojo.Log.info(&quot;KeyManager: export success=&quot;+JSON.stringify(e));},
  onFailure: function(e) {Mojo.Log.info(&quot;KeyManager: export failure=&quot;+JSON.stringify(e));}
});
</code>
</pre>
    </blockquote>
    <p>
      <a name="fetchKey" id="fetchKey">&#160;</a>
    </p>
    <hr>
    <h3 id="fetchkey">
      fetchKey
    </h3>
    <p>
      Returns key metadata and key data. Key data is returned if the key had been originally stored or generated with nohide = <code>true</code>. Otherwise, the call fails and a &quot;key is not exportable&quot; error message is returned.
    </p>
    <h4 id="schema-2">
      Schema
    </h4>
    <blockquote>
      <pre>
<code>{
  &quot;keyname&quot; : string
}
</code>
</pre>
    </blockquote>
    <h4 id="parameters-2">
      Parameters
    </h4>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            keyname
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            Key name.
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns-2">
      Returns
    </h4>
    <blockquote>
      <pre>
<code>{
  &quot;returnValue&quot; : boolean,
  &quot;errorText&quot;   : string, |
  &quot;keyname&quot;     : string,
  &quot;type&quot;        : string,
  &quot;keydata&quot;     : string
  &quot;nohide&quot;      : boolean
}
</code>
</pre>
    </blockquote>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure).
          </td>
        </tr>
        <tr>
          <td>
            errorText
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Error message returned on failure.
          </td>
        </tr>
        <tr>
          <td>
            keyname
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Key name. Returned on success.
          </td>
        </tr>
        <tr>
          <td>
            type
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Key type. One of the following—<code>&quot;AES&quot;, &quot;3DES&quot;, &quot;HMACSHA1&quot;, &quot;BLOB&quot;, or &quot;ASCIIBLOB&quot;</code>. Returned on success.
          </td>
        </tr>
        <tr>
          <td>
            keydata
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Optional key data string. Returned if <code>nohide</code> is <code>true</code>. Returned on success.
          </td>
        </tr>
        <tr>
          <td>
            nohide
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            If <code>true</code>, it means key data can be returned with this call. Returned on success.
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <blockquote>
      <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.keymanager/&quot;, {
  method: &quot;fetchKey&quot;,
  parameters: {
      &quot;keyname&quot; :&quot;MyKey&quot;
  },
  onSuccess: function(e){
      var MyKeyB64 = Base64.decode(e.keydata);
      Mojo.Log.info(&quot;KeyManager: fetchKey Success: keydata= &quot;+MyKeyB64+ &quot;, keyname=&quot;+e.keyname);
  },
  onFailure: function(e){ Mojo.Log.info(&quot;fetchKey Failure, err=&quot;+e.errorText); }
});
</code>
</pre>
    </blockquote>
    <p>
      <a name="generate" id="generate">&#160;</a>
    </p>
    <hr>
    <h3 id="generate">
      generate
    </h3>
    <p>
      Generates a key with the name specified. If <code>nohide = true</code>, the key data can be accessed with <code>fetchKey</code>.
    </p>
    <p>
      Types and their size requirements:
    </p>
    <ul>
      <li>AES—16 (default), 24 or 32 bytes. These sizes correspond to AES 128, 192 or 256 bit.
      </li>
      <li>3DES—24 bytes.
      </li>
      <li>HMACSHA1—16 bytes or up.
      </li>
      <li>BLOB—Up to 4096 bytes. The BLOB type is used for safely storing data of any kind.
      </li>
      <li>ASCIIBLOB—Same as BLOB but for storing ascii, JSON formatted text that is not base64 encoded.
      </li>
    </ul>
    <h4 id="schema-3">
      Schema
    </h4>
    <blockquote>
      <pre>
<code>{
  &quot;keyname&quot;: string,
  &quot;size&quot;   : integer,
  &quot;type&quot;   : string,
  &quot;nohide&quot; : boolean
}
</code>
</pre>
    </blockquote>
    <h4 id="parameters-3">
      Parameters
    </h4>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            keyname
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            Name of key to generate.
          </td>
        </tr>
        <tr>
          <td>
            size
          </td>
          <td>
            Yes
          </td>
          <td>
            integer
          </td>
          <td>
            Key size in bytes.
          </td>
        </tr>
        <tr>
          <td>
            type
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            Key type. Must be one of the following—<code>&quot;AES&quot;, &quot;3DES&quot;, &quot;HMACSHA1&quot;, &quot;BLOB&quot;, or &quot;ASCIIBLOB&quot;</code>.
          </td>
        </tr>
        <tr>
          <td>
            nohide
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            If <code>false</code> (default), the key data can not be exported with <code>fetchKey</code>.
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns-3">
      Returns
    </h4>
    <blockquote>
      <pre>
<code>{
  &quot;returnValue&quot; : boolean,
  &quot;errorText&quot;   : string
}
</code>
</pre>
    </blockquote>
    <table>
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure).
          </td>
        </tr>
        <tr>
          <td>
            errorText
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Error message returned on failure.
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <blockquote>
      <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.keymanager/&quot;, {
  method: &quot;generate&quot;,
  parameters: {
      &quot;keyname&quot; : &quot;MyGenKey&quot;,
      &quot;size&quot;    : 16,
      &quot;type&quot;    : &quot;HMACSHA1&quot;,
      &quot;nohide&quot;  : true
  },
  onSuccess: function(e){ Mojo.Log.info(&quot;KeyManager: Generate MyGenKey success, e=&quot;+JSON.stringify(e)); },
  onFailure: function(e){ Mojo.Log.info(&quot;KeyManager: Generate MyGenKey failure, e=&quot;+JSON.stringify(e)); }
});
</code>
</pre>
    </blockquote>
    <p>
      <a name="import" id="import">&#160;</a>
    </p>
    <hr>
    <h3 id="import">
      import
    </h3>
    <p>
      Import takes a wrapped key and imports it. If the wrapping key is not present, the key is not installed and an error is returned. If successful, the unwrapped key's name is returned. A wrapped key can not replace an existing key with the same owner and name.
    </p>
    <h4 id="schema-4">
      Schema
    </h4>
    <blockquote>
      <pre>
<code>{
  &quot;wrappedKey&quot;: string
}
</code>
</pre>
    </blockquote>
    <h4 id="parameters-4">
      Parameters
    </h4>
    <table border="1">
      <tbody>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
        <tr>
          <td>
            wrappedKey
          </td>
          <td>
            string
          </td>
          <td>
            Wrapped key.
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns-4">
      Returns
    </h4>
    <blockquote>
      <pre>
<code>{
  &quot;returnValue&quot; : boolean,
  &quot;errorText&quot;   : string, |
  &quot;keyname&quot;     : string
}
</code>
</pre>
    </blockquote>
    <table border="1">
      <tbody>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure).
          </td>
        </tr>
        <tr>
          <td>
            errorText
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Error message returned on failure. Returned on success.
          </td>
        </tr>
        <tr>
          <td>
            keyname
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Key name.
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <blockquote>
      <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.keymanager/&quot;, {
  method: &quot;import&quot;,
  parameters: {
      &quot;wrappedKey&quot;: &quot;MyWrappedKey&quot;
  },
  onSuccess: function(e){ Mojo.Log.info(&quot;Import success, e=&quot;+JSON.stringify(e)); },
  onFailure: function(e){ Mojo.Log.info(&quot;Import failure, e=&quot;+JSON.stringify(e)); }
});
</code>
</pre>
    </blockquote>
    <p>
      <a name="keyInfo" id="keyInfo">&#160;</a>
    </p>
    <hr>
    <h3 id="keyinfo">
      keyInfo
    </h3>
    <p>
      Returns the key's metadata but not the key data.
    </p>
    <h4 id="schema-5">
      Schema
    </h4>
    <blockquote>
      <pre>
<code>{
  &quot;keyname&quot; : string
}
</code>
</pre>
    </blockquote>
    <h4 id="parameters-5">
      Parameters
    </h4>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            keyname
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            Key name
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns-5">
      Returns
    </h4>
    <blockquote>
      <pre>
<code>{
  &quot;returnValue&quot; : boolean,
  &quot;errorText&quot;   : string, |
  &quot;keyname&quot;     : string,
  &quot;type&quot;        : string,
  &quot;nohide&quot;      : boolean,
  &quot;backup&quot;      : boolean,
  &quot;noexport&quot;    : boolean,
  &quot;cloud&quot;       : boolean,
  &quot;unwrap_only&quot; : boolean,
  &quot;shared&quot;      : boolean
}
</code>
</pre>
    </blockquote>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure).
          </td>
        </tr>
        <tr>
          <td>
            errorText
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Error message returned on failure.
          </td>
        </tr>
        <tr>
          <td>
            keyname
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Key name. Returned on success.
          </td>
        </tr>
        <tr>
          <td>
            type
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            One of the following—<code>&quot;AES&quot;, &quot;3DES&quot;, &quot;HMACSHA1&quot;, &quot;BLOB&quot;, or &quot;ASCIIBLOB&quot;</code>. Returned on success.
          </td>
        </tr>
        <tr>
          <td>
            nohide
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Indicates if key data is accessible via fetchKey (<code>true</code>), or can only be used for operations (<code>false</code>). Returned on success.
          </td>
        </tr>
        <tr>
          <td>
            backup
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Is this key backed up in the cloud with the device backup? Returned on success.
          </td>
        </tr>
        <tr>
          <td>
            noexport
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Key can be exported flag. Returned on success.
          </td>
        </tr>
        <tr>
          <td>
            cloud
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Is this key stored in the cloud and used for backups? Returned on success.
          </td>
        </tr>
        <tr>
          <td>
            unwrap_only
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            If <code>true</code>, key can only be used to unwrap wrapped keys and no other operation. Returned on success.
          </td>
        </tr>
        <tr>
          <td>
            shared
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Can other apps access the key flag. Returned on success.
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <blockquote>
      <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.keymanager/&quot;, {
  method: &quot;keyInfo&quot;,
  parameters: {
      &quot;keyname&quot; :&quot;MyKey&quot;
  },
  onSuccess: function(e){ Mojo.Log.info(&quot;keyInfo Success: type= &quot;+e.type); },
  onFailure: function(e){ Mojo.Log.info(&quot;keyInfo Failure err=&quot;+JSON.stringify(e)); }
});
</code>
</pre>
    </blockquote>
    <p>
      <a name="remove" id="remove">&#160;</a>
    </p>
    <hr>
    <h3 id="remove">
      remove
    </h3>
    <p>
      Given a key name, removes a key from the key store.
    </p>
    <h4 id="schema-6">
      Schema
    </h4>
    <blockquote>
      <pre>
<code>{
  &quot;keyname&quot; : string
}
</code>
</pre>
    </blockquote>
    <h4 id="parameters-6">
      Parameters
    </h4>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            keyname
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            Key name.
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns-6">
      Returns
    </h4>
    <blockquote>
      <pre>
<code>{
  &quot;returnValue&quot; : boolean,
  &quot;errorText&quot;   : string
}
</code>
</pre>
    </blockquote>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure).
          </td>
        </tr>
        <tr>
          <td>
            errorText
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Error message on failure.
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <blockquote>
      <pre>
<code>this.controller.serviceRequest(&quot;palm://com.palm.keymanager/&quot;, {
  method: &quot;remove&quot;,
  parameters: {
      &quot;keyname&quot; : &quot;MyKey4&quot;
  },
  onSuccess: function(e){ Mojo.Log.info(&quot;Remove key success&quot;); },
  onFailure: function(e){ Mojo.Log.info(&quot;Remove key failure, err=&quot;+JSON.stringify(e)); }
});
</code>
</pre>
    </blockquote>
    <p>
      <a name="store" id="store">&#160;</a>
    </p>
    <hr>
    <h3 id="store">
      store
    </h3>
    <p>
      Stores a key in the database given a key name, data, key encryption algorithm type, and other optional parameters.
    </p>
    <p>
      Key data needs to be base64 encoded unless its <code>type</code> is <code>ASCIIBLOB</code>. Since JSON objects are composed and formatted with ascii (UTF-8) text, data needs to be base64 encoded to avoid having it interpreted as JSON formatting instructions. The webOS JavaScript foundation libraries provide the following base64 encoding/decoding functions: <strong>TBD</strong>
    </p>
    <p>
      <code>Type</code> must be one of the supported key types—<code>AES, 3DES, HMACSHA1, BLOB, or ASCIIBLOB.</code> <code>BLOB</code> is not actually a key type, but can be used to safely store data (up to 4096 bytes) of any kind. <code>ASCIIBLOB</code> is the same as <code>BLOB</code>, but for storing ascii, JSON formatted text.
    </p>
    <p>
      If <code>nohide</code> is set to <code>false</code> (default), the key data can not be exported with <a href="#fetchKey">fetchKey</a>. <code>BLOB</code> types should not have <code>nohide</code> set, as that makes them useless.
    </p>
    <p>
      The <code>backup</code> flag (keys backed up in the cloud with the device backup) is <code>false</code> by default.
    </p>
    <p>
      The <code>cloud</code> flag indicates a key which is stored in the cloud and is a special key for backups. If <code>true</code>, The type should be <code>ASCIIBLOB</code> and the keydata contains the backup-specific part of the URL for fetching the key.
    </p>
    <h4 id="schema-7">
      Schema
    </h4>
    <blockquote>
      <pre>
<code>{
  &quot;keyname&quot; : string,
  &quot;keydata&quot; : string,
  &quot;type&quot;    : string,
  &quot;nohide&quot;  : boolean,
  &quot;backup&quot;  : boolean,
  &quot;cloud&quot;   : boolean
}
</code>
</pre>
    </blockquote>
    <h4 id="parameters-7">
      Parameters
    </h4>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            keyname
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            Key name.
          </td>
        </tr>
        <tr>
          <td>
            keydata
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            Key data.
          </td>
        </tr>
        <tr>
          <td>
            type
          </td>
          <td>
            Yes
          </td>
          <td>
            string
          </td>
          <td>
            Key algroithm encryption type. Must be one of the following—AES, 3DES, HMACSHA1, BLOB, or ASCIIBLOB. 3DES keys must be properly formed with DES parity bits and weak key checking already done.
          </td>
        </tr>
        <tr>
          <td>
            nohide
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            If <code>false</code> (default), the key data can not be exported with <code>fetchKey</code>.
          </td>
        </tr>
        <tr>
          <td>
            backup
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            If <code>true</code>, this key is backed up in the cloud with the device backup. This field is <code>false</code> by default.
          </td>
        </tr>
        <tr>
          <td>
            cloud
          </td>
          <td>
            No
          </td>
          <td>
            boolean
          </td>
          <td>
            Indicates a key which is stored in the cloud and is a special key for backups. The type should be <code>ASCIIBLOB</code> and the <code>keydata</code> contains the backup-specific part of the URL for fetching the key.
          </td>
        </tr>
      </tbody>
    </table>
    <h4 id="returns-7">
      Returns
    </h4>
    <blockquote>
      <pre>
<code>{ 
  &quot;returnValue&quot; : boolean,
  &quot;errorText&quot;   : string
}
</code>
</pre>
    </blockquote>
    <table border="1">
      <thead>
        <tr>
          <th>
            Argument
          </th>
          <th>
            Required
          </th>
          <th>
            Type
          </th>
          <th>
            Description
          </th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            returnValue
          </td>
          <td>
            Yes
          </td>
          <td>
            boolean
          </td>
          <td>
            <code>true</code> (success) or <code>false</code> (failure).
          </td>
        </tr>
        <tr>
          <td>
            errorText
          </td>
          <td>
            No
          </td>
          <td>
            string
          </td>
          <td>
            Error message returned on failure.
          </td>
        </tr>
      </tbody>
    </table>
    <p>
      <strong>Example</strong>
    </p>
    <blockquote>
      <pre>
<code>// The following base64 encoding functionality is something YOU need to provide
var KeyDataB64 = Base64.encode(&quot;123456&quot;);
this.controller.serviceRequest(&quot;palm://com.palm.keymanager/&quot;, {
  method: &quot;store&quot;,
  parameters: {
      &quot;keyname&quot; : &quot;MyKey&quot;,
      &quot;keydata&quot; : KeyDataB64,
      &quot;type&quot;    : &quot;AES&quot;,
      &quot;nohide&quot;  : true
  },
  onSuccess: function(e){ Mojo.Log.info(&quot;Store key success&quot;); },
  onFailure: function(e){ Mojo.Log.info(&quot;Store key failure, err=&quot;+JSON.stringify(e)); }
});
</code>
</pre>
    </blockquote>
		</div>
	</body>
</html>